{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "NPC Dialogue Record",
  "type": "object",
  "required": ["id", "source", "split", "dialog"],
  "properties": {
    "id": {"type": "string"},
    "source": {"type": "string", "enum": ["personachat","spc","charcodex","light","skyrim","fallout","ed","uesp"]},
    "split": {"type": "string"},
    "persona": {"type":"array","items":{"type":"string"}},
    "world_facts": {"type":"array","items":{"type":"string"}},
    "context": {
      "type":"object",
      "properties":{
        "location":{"type":"string"},
        "npc_role":{"type":"string"},
        "time_of_day":{"type":"string"},
        "player_state":{"type":"object"}
      }
    },
    "intent":{"type":"string"},
    "control":{"type":"object"},
    "dialog":{
      "type":"array",
      "minItems":1,
      "items":{"type":"object","required":["role","text"],
        "properties":{"role":{"type":"string"},"text":{"type":"string"}}}
    },
    "choices":{"type":"array","items":{"type":"object"}},
    "transaction":{"type":"object"},
    "meta":{"type":"object"}
  },
  "additionalProperties": false
}